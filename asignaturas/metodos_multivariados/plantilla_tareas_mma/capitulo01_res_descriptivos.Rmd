---
author: "Nombre Completo Autor"
date: "06/02/2024"
documentclass: book
forprint: true
fontsize: 12pt
geometry: margin = 2.5cm
bibliography:
- bib/library.bib
- bib/paquetes.bib
metodobib: true
biblio-style: plainnat
csl: "methods-in-ecology-and-evolution.csl"
link-citations: true
output:
  html_document:
    df_print: paged
  pdf_document:
    keep_tex: false
    number_sections: true
    citation_package: natbib
    fig_caption: true
    template: latex/plantilla_iam.tex
    includes: null
---

```{r include=FALSE}
if(!require(pacman)){install.packages("pacman"); library(pacman)}
pacman::p_load("tidyverse", "ggplot2", "pBrackets", "knitr", "HH", "car", "rgl", "sampling","kableExtra","leaps","tidyr","vctrs","exams","MASS","rsm","magrittr","kableExtra","Hmisc","pastecs","psych","data.table","stargazer","reporttools","ggplot2","corrplot")

#options(kableExtra.latex.load_packages = F)
knitr::opts_chunk$set(fig.path = 'figurasR/',
                      echo = FALSE, warning = FALSE, message = FALSE,
                      fig.pos="H",fig.align="center",out.width="80%",
                      cache=FALSE,comment = NA)

source("funcionesR/funciones1.R", local = knitr::knit_global())

knitr::write_bib(c(.packages(),"knitr","rmarkdown"),file="bib/paquetes.bib", width = 60)

#exams::include_supplement("myQQnorm.R")
#source("myQQnorm.R")
```

```{=tex}
\ifdefined\ifprincipal
\else
\setlength{\parindent}{1em}
\pagestyle{fancy}
\setcounter{tocdepth}{4}
\tableofcontents
```
<!-- \nocite{*} -->

\fi

```{=tex}
\ifdefined\ifdoblecara
\fancyhead{}{}
\fancyhead[LE,RO]{\scriptsize\rightmark}
\fancyfoot[LO,RE]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[LE,RO]{\footnotesize\thepage}
\else
\fancyhead{}{}
\fancyhead[RO]{\scriptsize\rightmark}
\fancyfoot[LO]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[RO]{\footnotesize\thepage}
\fi
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
```
# Resúmen Descriptivo

## Tabla de Datos

```{r echo=FALSE}
mineral<-read.table("datos/mineral_huesos.txt", header = TRUE)
attach(mineral)

mineral %>% 
  knitr::kable(booktabs = TRUE,caption="Tabla de Datos",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

## Vector de Medias

```{r}
sapply(mineral,mean,na.rm=TRUE) %>% 
  knitr::kable(booktabs = TRUE,caption="Vector de Medias",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

## Matriz de Var-Cov Muestral

```{r}
var_cov <- cov(mineral)

round(var_cov,3) %>% 
knitr::kable(booktabs = TRUE,caption="Matriz de Var-Cov",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

## Matriz de Correlación Muestral

```{r}
corr <- cor(mineral)

round(corr,3) %>% 
knitr::kable(booktabs = TRUE,caption="Matriz de Correlaciones",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

## Algunos valores de resúmenes descriptivos de la variable: Radio

**Asimetría:**

El Coeficiente de asimetria de la variable radio es: `r asimetria(radio)`

**Kurtosis:**

El Coeficiente de kurtosis de la variable radio es: `r kurtosis(radio)`

**Estadisticos de Tukey: min,q1,median,q3,max**

```{r}
t(fivenum(mineral[,2]) ) %>% 
  knitr::kable(booktabs = TRUE,caption="Estadísticos de Tukey",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

**Uso de la función `describe` del Paquete `Hmisc`**

```{r}
#library(Hmisc)
t(describe(mineral[,2]) ) %>% 
  knitr::kable(booktabs = TRUE,caption="Estadísticos de `describe`",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)      
```

**Uso de la función: `stat.desc` del paquete `pastecs`**

```{r}
#library(pastecs)
t(stat.desc(mineral[,2]) ) %>% 
  knitr::kable(booktabs = TRUE,caption="Estadísticos de `stat.desc`",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 6)      
```

**Uso de la función: `describe` del paquete `psych`**

```{r}
#library(psych)
describe(mineral[,]) %>% 
  knitr::kable(booktabs = TRUE,caption="Estadísticos de *psych*",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 6)           
```

**Uso de la función: `data.table` del paquete `data.table`**

```{r}
#library(data.table)
#library(pastecs)
tablita <- stat.desc(mineral[,1:3])

tablita1 <- data.table(Estadisticos=rownames(tablita),tablita)

tablita %>% 
knitr::kable(caption="Resumen de Datos con *stat.desc*",digits=4,align = 'lrrr') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

```{r}
tablita1 %>% 
knitr::kable(caption="Resumen de Datos con *data.table*",digits=4,align = 'lrrr') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)           
```

**Uso de la función: `stargazer` del paquete `stargazer`**

```{r eval=FALSE}
#library(stargazer)
stargazer(mineral[,1:3],header=FALSE,title = "Resumen de Datos con stargazer",digits=4)
```

```{=tex}
\begin{table}[!htbp] \centering
\caption{Resumen de Datos con stargazer}
\label{tabla-1}
\begin{tabular}{lccccc}
\\[-1.8ex]\hline
\hline \\[-1.8ex]
Statistic & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{Mean} & \multicolumn{1}{c}{St. Dev.} & \multicolumn{1}{c}{Min} & \multicolumn{1}{c}{Max} \\
\hline \\[-1.8ex]
dradio & 25 & 0.8438 & 0.1140 & 0.4930 & 1.1030 \\
radio & 25 & 0.8183 & 0.1069 & 0.5320 & 1.0520 \\
dhumero & 25 & 1.7927 & 0.2835 & 1.0370 & 2.3340 \\
\hline \\[-1.8ex]
\end{tabular}
\end{table}
```
## Variables Cruzadas

**Uso de la función: `reporttools`, para Cruzar Continuas con Categóricas**

```{r}
#library(reporttools)              
cate <- factor(rep(c("A","B","C","D"),c(5,5,5,10)))

data2 <- cbind(mineral,cate)

data2 %>% 
  knitr::kable(booktabs = TRUE,caption="Tabla de Datos",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

```{r eval=FALSE}
titulo <- "Resumen de los Datos con reporttools"
vbles <- data2[,1:3]

estadisticas <- list("mean","s",
                   "c$_{\\mathrm{v}}\\%$"=
                     function(x){
                     return((sd(x)/mean(x))*100)
                     },
                   "min","median","max","n", "na"
                     )

#Cruece da vbles_cont con vbles_nominal
tableContinuous(vars = vbles, group = data2[,7], stats = estadisticas,cap=titulo, print.pval = "kruskal",longtable=FALSE)
```

```{=tex}
\begin{table}[ht]
\centering
\begingroup\footnotesize
\begin{tabular}{llrrrrrrrr}
\textbf{Variable} & \textbf{Levels} & $\mathbf{\bar{x}}$ & $\mathbf{s}$ & c$_{\mathrm{v}}\%$ & \textbf{Min} & $\mathbf{\widetilde{x}}$ & \textbf{Max} & $\mathbf{n}$ & \textbf{NA} \\
\hline
dradio & A & 0.9 & 0.1 & 13.3 & 0.8 & 0.9 & 1.1 & 5 & 0 \\
& B & 0.9 & 0.1 & 8.8 & 0.8 & 0.9 & 0.9 & 5 & 0 \\
& C & 0.8 & 0.1 & 7.3 & 0.8 & 0.8 & 0.9 & 5 & 0 \\
& D & 0.8 & 0.1 & 17.3 & 0.5 & 0.8 & 0.9 & 10 & 0 \\
\hline
$p= 0.45$ & all & 0.8 & 0.1 & 13.5 & 0.5 & 0.9 & 1.1 & 25 & 0 \\
\hline
radio & A & 0.9 & 0.1 & 13.2 & 0.7 & 0.9 & 1.1 & 5 & 0 \\
& B & 0.9 & 0.0 & 5.6 & 0.8 & 0.9 & 0.9 & 5 & 0 \\
& C & 0.8 & 0.1 & 7.5 & 0.7 & 0.8 & 0.9 & 5 & 0 \\
& D & 0.8 & 0.1 & 17.2 & 0.5 & 0.8 & 0.9 & 10 & 0 \\
\hline
$p= 0.40$ & all & 0.8 & 0.1 & 13.1 & 0.5 & 0.8 & 1.1 & 25 & 0 \\\hline
dhumero & A & 1.9 & 0.2 & 8.8 & 1.7 & 1.9 & 2.1 & 5 & 0 \\
& B & 1.7 & 0.2 & 9.4 & 1.5 & 1.7 & 2.0 & 5 & 0 \\
& C & 1.8 & 0.3 & 14.9 & 1.5 & 1.8 & 2.2 & 5 & 0 \\
& D & 1.8 & 0.4 & 22.0 & 1.0 & 1.8 & 2.3 & 10 & 0 \\
\hline
$p= 0.90$ & all & 1.8 & 0.3 & 15.8 & 1.0 & 1.8 & 2.3 & 25 & 0 \\
\hline
\end{tabular}
\endgroup
\caption{Resumen de los Datos con reporttools}
\label{tabla-2}
\end{table}
```
**Uso de la función: `reporttools`, para Cruzar Continuas con Categóricas, Ejemplo-2**

```{r}
#library(reporttools)              
cate <- factor(rep(c("A","B","C","D"),c(5,5,5,10)))
cate1 <- factor(rep(c("A","B","C","D"),c(10,5,5,5)))
data2 <- cbind(mineral,cate,cate1)

data2 %>% 
  knitr::kable(booktabs = TRUE,caption="Tabla de Datos",align = 'c') %>% 
kableExtra::kable_styling(full_width = F,latex_options = "HOLD_position",  font_size = 8)
```

```{r eval=FALSE}
# solo tabla de vbles_nominales
titulo2 <- "Caracteristicas de Las Variables Nominales"
tableNominal(vars = data2[ ,7:8],cap=titulo2,vertical = FALSE,font.size = "scriptsize",lab = "tab:nominal1",longtable = FALSE,cumsum = TRUE)
```

```{=tex}
\begin{table}[ht]
\centering
\begingroup\scriptsize
\begin{tabular}{llrrr}
\textbf{Variable} & \textbf{Levels} & $\mathbf{n}$ & $\mathbf{\%}$ & $\mathbf{\sum \%}$ \\
\hline
cate & A & 5 & 20.0 & 20.0 \\
& B & 5 & 20.0 & 40.0 \\
& C & 5 & 20.0 & 60.0 \\
& D & 10 & 40.0 & 100.0 \\
\hline
& all & 25 & 100.0 & \\
\hline
\hline
cate1 & A & 10 & 40.0 & 40.0 \\
& B & 5 & 20.0 & 60.0 \\
& C & 5 & 20.0 & 80.0 \\
& D & 5 & 20.0 & 100.0 \\
\hline
& all & 25 & 100.0 & \\
\hline
\hline
\end{tabular}
\endgroup
\caption{Caracteristicas de Las Variables Nominales}
\label{tab:nominal1}
\end{table}
```
## Gráficos Varios

### Gráficos de Puntos

**Gráficos de puntos para Radio:**

```{r grafica1a,fig.cap='Gráficos de Puntos'}
stripchart(radio, method="overplot", ylab = "Cantidad de datos", xlab = "Valores de la Variables Radio",main = "Gráficos de Puntos: overplot,stack,jitter")
stripchart(radio, method="stack",add = TRUE, at = 1.2)
stripchart(radio, method="jitter",add = TRUE, at = 0.7)
```

**Gráficos de puntos para Datos Normales:**

```{r grafica1b,fig.cap='Gráficos de Puntos'}
x <- stats::rnorm(50)
xr <- round(x, 1)
stripchart(x,ylab = "Cantidad de datos", xlab = "Valores de la Variable",
main = "Gráfico de Puntos: overplot, stack,jitter" )  
stripchart(xr, method = "stack", add = TRUE, at = 1.2)
stripchart(xr, method = "jitter", add = TRUE, at = 0.7)
```

### Gráficos de Dispersión o Scatterplot

```{r grafica1c,fig.cap='Gráficos de Dispersión con Histogramas'}
scatterhist(radio,cubito, xlab="Radio", ylab="Cúbito")
```

```{r grafica1d,fig.cap='Gráficos de Dispersión con Box-Plot'}
par(fig=c(0,0.8,0,0.8), new=TRUE)
plot(radio,cubito, xlab="Radio", ylab="Cúbito")
par(fig=c(0,0.8,0.5,1), new=TRUE)
boxplot(radio, horizontal=TRUE, axes=FALSE)
par(fig=c(0.7,1,0,0.8),new=TRUE)
boxplot(cubito, axes=FALSE)
```

```{r grafica1e,fig.cap='Gráficos de Dispersión con Gráficos de Puntos'}
par(fig=c(0,0.8,0,0.8), new=TRUE)
plot(radio,cubito, xlab="Radio", ylab="Cúbito")
par(fig=c(0,0.8,0.55,1), new=TRUE)
stripchart(radio, method="jitter", axes=FALSE)
par(fig=c(0.65,1,0,0.8),new=TRUE)
stripchart(cubito, method="jitter", vertical="TRUE",  axes=FALSE)
```

### Matriz de Dispersión

```{r, grafica1f,out.width = '70%',fig.cap='Matriz de Dispersión de Datos, Box-Plot-Corr'}
pairs(mineral, lower.panel = myPanel.cor, upper.panel = panel.smooth, diag.panel=myPanel.box, labels = names(mineral) )
```

```{r, grafica1g,out.width = '70%',fig.cap='Matriz de Dispersión de Datos, Histogramas-Corr'}
pairs(mineral, lower.panel = myPanel.cor, upper.panel = panel.smooth, diag.panel=myPanel.hist, labels = names(mineral) )
```

```{r, grafica1h,out.width = '70%',fig.cap='Matriz de Dispersión de Datos, Corr'}
pairs(mineral, lower.panel = myPanel.cor, upper.panel = panel.smooth, labels = names(mineral) )
```

## Gráfica de la Matriz de Correlaciones

```{r, grafica1i,out.width = '60%',fig.cap='Matriz de Correlaciónes'}
#library(ggplot2)
#library(corrplot)

matcorrs.cor <- cor(mineral,method="pearson")
# Gráfico de la MAtriz de Correlación por default
corrplot(matcorrs.cor)
```

```{r, grafica1j,out.width = '60%',fig.cap='Matriz de Correlaciónes2'}
# metodo(forma),color-forma,color-etiquetas,inclinación-etiquetas
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45 )
```

```{r, grafica1k,out.width = '60%',fig.cap='Matriz de Correlaciónes3'}
# metodo(forma),color-forma,color-etiquetas,inclinación-etiquetas
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",
         tl.srt=45,addCoef.col="black",order="AOE" ) 
```

```{r, grafica1l,out.width = '60%',fig.cap='Matriz de Correlaciónes4'}
# Definir una paleta de colores
col <- colorRampPalette(c("#BB4444","#EE9988","#FFFFFF","#77AADD","#4477AA"))

# addCoef.col,order
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE" )
```

```{r, grafica1m,out.width = '60%',fig.cap='Matriz de Correlaciónes5'}
# Gráfica Triagular
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="lower" )
```

```{r, grafica1n,out.width = '60%',fig.cap='Matriz de Correlaciónes6'}
# Gráfica Triagular
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper" )
```

```{r, grafica1o,out.width = '60%',fig.cap='Matriz de Correlaciónes7'}
# Gráfica Triagular
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F)
```

```{r, grafica1p,out.width = '60%',fig.cap='Matriz de Correlaciónes8'}
# Gráfica Triagular
corrplot(matcorrs.cor,method="shade",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,
         addshade="all")
```

```{r, grafica1q,out.width = '60%',fig.cap='Matriz de Correlaciónes9'}
corrplot(matcorrs.cor,method="circle",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,addshade="all" )
```

```{r, grafica1r,out.width = '60%',fig.cap='Matriz de Correlaciónes10'}
corrplot(matcorrs.cor,method="ellipse",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,addshade="all" )
```

```{r, grafica1s,out.width = '60%',fig.cap='Matriz de Correlaciónes11'}
corrplot(matcorrs.cor,method="pie",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,addshade="all" )
```

```{r, grafica1t,out.width = '60%',fig.cap='Matriz de Correlaciónes12'}
corrplot(matcorrs.cor,method="color",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,addshade="all" )
```

```{r, grafica1u,out.width = '60%',fig.cap='Matriz de Correlaciónes13'}
corrplot(matcorrs.cor,method="square",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="AOE",type="upper",diag=F,addshade="all" )
```

```{r, grafica1v,out.width = '60%',fig.cap='Matriz de Correlaciónes14'}
corrplot(matcorrs.cor,method="square",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="FPC",type="upper",
diag=F,addshade="all" )
```

```{r, grafica1w,out.width = '60%',fig.cap='Matriz de Correlaciónes15'}
corrplot(matcorrs.cor,method="square",shade.col=NA,tl.col="black",tl.srt=45,col=col(200),addCoef.col="black",order="hclust",type="upper",diag=F,addshade="all" )
```
